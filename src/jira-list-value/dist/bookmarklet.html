<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      html,body,div { margin: 0; padding: 0; font: normal 16px/24px Helvetica Neue, Helvetica, sans-serif; color: #333; }
      #main { max-width: 630px; margin: 3em auto; }
      .bookmarklet { display: inline-block; padding: .5em 1em; color: #fff; background: #50dcf3; border-radius: 4px; text-decoration: none; }
      a { color: #50dcf3; }
      .dim { color: #999; }
    </style>
  </head>
  <body>
    <div id="main">
      <h1>Bookmarklet</h1>
      <p>
        Drag this button to your bookmarks bar to save it as a bookmarklet:
      </p>
      <p>
        <a class="bookmarklet" href="javascript:(function()%7B%22use%20strict%22%3Bfunction%20sum(e%2Ct%2Cn)%7Breturn%20e.slice(t%2Cn).reduce((function(e%2Ct)%7Breturn%20e%2Bt%7D)%2C0)%7Dfunction%20getTimeFieldValue(e)%7Breturn%20e.fields.resolutiondate%7Dfunction%20getTimeField(e)%7Breturn%20new%20Date(getTimeFieldValue(e)).getTime()%7Dfunction%20formatFirstDay(e)%7Bvar%20t%3D1%3Carguments.length%26%26void%200!%3D%3Darguments%5B1%5D%3Farguments%5B1%5D%3A1%3Breturn%22%22.concat(e.getYear()%2B1900%2C%22-%22).concat(e.getMonth()%2Bt%2C%22-1%22)%7Dvar%20PRICE_FIELD%3D%22customfield_11241%22%3Bfunction%20getResolvedByDate()%7Bvar%20e%2Ct%3Dprompt(%22Enter%20min%20date.%20(resolved%20%3E%3D%20minDate)%22%2CformatFirstDay(new%20Date))%2Cn%3Dprompt(%22Enter%20max%20date.%20(resolved%20%3C%20maxDate)%22%2CformatFirstDay(new%20Date(t)%2C2))%2Co%3D%22%2Frest%2Fapi%2F2%2Fsearch%3Ffilter%3D-4%26jql%3Dassignee%20in%20(currentUser())%20AND%20status%20%253D%20Resolved%20AND%20%22%2B'resolved%20%3E%3D%20%22'.concat(t%2C'%22%20AND%20resolved%20%3C%20%22').concat(n%2C'%22%20order%20by%20resolutiondate%20DESC')%3Bconsole.log(o)%3Bvar%20r%3DparseFloat(null!%3D%3D(e%3Dprompt(%22Enter%20a%20multiplier%20for%20currency%20conversion.%20(Use%20this%20if%20accounting%20and%20invoicing%20is%20done%20in%20different%20currencies.%20Provide%20how%20much%20invoicing%20currency%20you%20get%20for%20one%20accounting%20currency%2C%20e.g.%20how%20much%20HUF%20for%201%20EUR.%20Leave%20it%20as%201%20if%20you%20don'%20need%20currency%20conversion.)%22%2C1))%26%26void%200!%3D%3De%3Fe%3A1)%3Bfetch(o).then((function(e)%7Breturn%20e.json()%7D)).then((function(e)%7Bvar%20t%3De.issues.filter((function(e)%7Breturn%20e.fields%5BPRICE_FIELD%5D%7D)).sort((function(e%2Ct)%7Breturn%20e.key%3Et.key%3F1%3A-1%7D))%2Cn%3Dt.map((function(e)%7Breturn%22%22.concat(e.key%2C%22%3A%20%22).concat(e.fields.summary%2C%22%20(%22).concat(e.fields%5BPRICE_FIELD%5D%2C%22)%22)%7D))%2Co%3Dsum(e.issues.map((function(e)%7Breturn%20e.fields%5BPRICE_FIELD%5D%7D)))%2Ci%3Do.toString()%3Bif(!isNaN(r)%26%261!%3Dr)%7Bvar%20c%3DMath.round(o*r)%3Bi%3D%22%22.concat(i%2C%22%20(invoice%3A%20%22).concat(c%2C%22)%22)%3Bvar%20a%3Dt.map((function(e)%7Breturn%20Math.floor(e.fields%5BPRICE_FIELD%5D*r)%7D))%3Bn%3Dn.map((function(e%2Ct)%7Bvar%20o%3Dt%3Cn.length-1%3Fa%5Bt%5D%3Ac-sum(a%2C0%2C-1)%3Breturn%22%22.concat(e%2C%22%20(invoice%3A%20%22).concat(o%2C%22)%22)%7D))%7Dvar%20s%3DgetTimeFieldValue(t%5B0%5D)%2Cu%3DgetTimeFieldValue(t%5Bt.length-1%5D)%2Cl%3D%5Bn.join(%22%5Cn%22)%2C%22Total%3A%20%22.concat(i)%2C%22Date%20Range%3A%20%22.concat(s%2C%22%20-%20%22).concat(u)%5D.join(%22%5Cn%5Cn%5Cn%22)%2Cd%3Ddocument.createElement(%22pre%22)%3Bdocument.body.appendChild(d)%2Cd.innerHTML%3Dl%2Cd.style.display%3D%22block%22%2Cd.style.position%3D%22fixed%22%2Cd.style.width%3D%22100vw%22%2Cd.style.height%3D%22100vh%22%2Cd.style.top%3D0%2Cd.style.left%3D0%2Cd.style.zIndex%3D99999%2Cd.style.background%3D%22white%22%3Bvar%20f%3Ddocument.createElement(%22button%22)%3Bf.innerHTML%3D%22Close%22%2Cf.style.display%3D%22block%22%2Cf.onclick%3Dfunction()%7Breturn%20d.parentElement.removeChild(d)%7D%2Cd.appendChild(f)%7D))%7DgetResolvedByDate()%3B%7D)()">Bookmarklet</a>
      </p>
      
      <p class="dim">This page was created with the <a href="https://github.com/mrcoles/bookmarklet">bookmarklet</a> npm library.</p>
    </div>
  </body>
</html>
